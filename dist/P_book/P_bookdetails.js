(function(e){typeof define=="function"&&define.amd?define("add",[""],e):e(jQuery)})(function(){$.fn.addModule=function(e,t,n,r){var t=new n(r);e.children(t.id).length==0?(e.append(t.html),setTimeout(function(){t.main(),t.render()},9)):setTimeout(function(){t.main(),t.render()},9)}}),function(e){typeof define=="function"&&define.amd?(requirejs.config({paths:{add:"../tools/addmodule"}}),define("G_comment",["add"],e)):e(jQuery)}(function(){function e(t){this.html='	<div id="comment">		<span>1</span>		<h1>评论区</h1>		<ul class="ul1">			<li>				<img src="../img/user/user.jpg"/>				<h4>user01 <span> 删除</span></h4>				<p>content! content! content!</p>				<a href="#textarea" name="oid">回复</a>				<div>					<img src="../img/user/user.jpg"/>					<h4>user01 <span> 删除</span></h4>					<p> <span>回复-user2 : </span>content! content!content! content!</p>					<a href="#textarea" name="oid">回复</a>				</div>				<div>					<img src="../img/user/user.jpg"/>					<h4>user01</h4>					<p>content! content!</p>					<a href="#textarea" name="oid">回复</a>				</div>			</li>			<li><img src="../img/user/user.jpg"/><h4>user01</h4><p>nice!</p><a href="#textarea" name="oid">回复</a></li>		</ul>		<textarea id="textarea"  cols="60" rows="4"></textarea><br/>		<button class="btn-opacity" type="button">submit</button>	</div>',this.id="#comment",this.opts=$.extend({},e.STATE,t)}return e.STATE={paths:{ajaxURL1:"/ajax/book/comment",ajaxURL2:"/ajax/book/comment/del"}},e.prototype.main=function(){var e=this.opts,t=this,n=0,r=null,i="";$("#comment>ul>li a").click(function(e){$("#comment textarea").focus(),n=$(this).attr("name"),r=$(this).siblings("h4").text(),i=$(this).parents("li")}),$("#comment>button").click(function(t){var s=$("#comment>span").text(),o=$("#comment>textarea").val();$.post(e.paths.ajaxURL1,{book_id:s,content:o,comment_id:n,to:r},function(e){if(e.status=="noSession")n=0,alert("请先登陆");else{var t='<img src="../../img/user/user.jpg"/>',r="<h4>"+e.form+"</h4>",s="<p>"+o+"</p>",u="<li>"+t+r+s+"</li>",a="<div>"+t+r+s+"</div>";$("#comment>textarea").val(null),e.status=="comment"?(alert("评论成功"),$("div#comment>ul.ul1").append(u)):e.status=="reply"&&(n=0,alert("回复成功"),i.append(a))}},"json")}),$("#comment>ul *>h4>span").click(function(t){var n=$(this).parent().parent(),r=$(this).attr("id"),i=$(this).attr("name");$.post(e.paths.ajaxURL2,{comment_id:r,time:i},function(e){e.status=="error"?alert("删除失败"):e.status=="success"&&(alert("删除成功"),n.remove())},"json")})},e.prototype.render=function(){var e=this.opts},e}),function(e){typeof define=="function"&&define.amd?(requirejs.config({paths:{add:"../tools/addmodule"}}),define("G_login",["add"],e)):e(jQuery)}(function(e){function t(e){this.html='<section id="login">	<div class="myleft inFLeft">		<a href="" class="a5 ">回到首页</a>		<a href="" class="a5 hide">录入新图书</a>		<a href="" class="a5 hide">图书管理</a>	</div>	<div class="myright inFLeft marright1">		<a  class="a1">登录</a>		<a  class="a2">注册</a>		<a  class="a3 hide">欢迎</a>		<a  class="a4 hide">注销</a>	</div>	<div id="login_block" class="hide">	<h1>movie 后台管理登陆</h1>	<form>		<label for="">账号:</label><input type="text" placeholder="username" class="form-input"/><br/>		<label for="">密码:</label><input type="password" placeholder="password" class="form-input"/><br/>		<button class="btn-opacity" type="button">login</button>	</form>	</div>	<div id="sign_block" class="hide">	<h1>用户注册</h1>	<form>		<label for="">账号:</label><input type="text" placeholder="username" class="form-input"/><br/>		<label for="">密码:</label><input type="password" placeholder="password" class="form-input"/><br/>		<label for="">密码:</label><input type="password" placeholder="password" class="form-input"/><br/>		<button class="btn-opacity" type="button">login</button>	</form>	</div></section>',this.id="#login",this.opts=$.extend({},t.STATE,e)}return t.STATE={},t.prototype.main=function(){var e=this.opts,t=this;$("#login a.a1").click(function(e){e.stopPropagation(),$("#login>#login_block").removeClass("hide")}),$("#login a.a2").click(function(e){e.stopPropagation(),$("#login>#sign_block").removeClass("hide")}),$("body").click(function(e){$("#login>#login_block,#login>#sign_block").addClass("hide")}),$("#login>#login_block,#login>#sign_block").click(function(e){e.stopPropagation()}),$("#login>#login_block>form>button").click(function(e){var t=$(this).siblings("input"),n=t.eq(0).val(),r=t.eq(1).val();$.post("/ajax/book/adminlogin",{name:n,pass:r},function(e){e.status=="err"?alert("账号或密码错误"):(alert("success"),window.location.reload())},"json")}),$("#login a.a4").click(function(e){$.post("/ajax/book/logout",[],function(e){e.status=="success"&&window.location.reload()},"json")}),$(window).scroll(function(e){var t=$(window).scrollTop();t>50?$("#login").addClass("test"):$("#login").removeClass("test")}),$("#login>#sign_block>form>button").click(function(e){var t=$(this).siblings("input"),n=t.eq(0).val(),r=t.eq(1).val(),i=t.eq(2).val();r!=i?alert("两次密码不一致"):n==""||r==""||i==""?alert("不能留空"):$.post("/ajax/book/sign",{name:n,pass:i},function(e){if(e.status=="err")alert("账号已经注册");else{var t=e.href;alert("注册成功，请重新登陆"),window.location.reload()}},"json")})},t.prototype.render=function(){var e=this.opts},t}),function(e){typeof define=="function"&&define.amd?(requirejs.config({paths:{add:"../tools/addmodule",G_comment:"../G_comment/G_comment2",G_login:"../G_login/G_login"}}),define("P_bookdetails",["add","G_comment","G_login"],e)):e(jQuery)}(function(e,t,n){function r(e){this.html="",this.id="#bookdetails",this.opts=$.extend({},r.STATE,e)}r.STATE={},r.prototype.main=function(){var e=this.opts,t=this},r.prototype.render=function(){var e=this.opts},$.fn.addModule($("body"),"G_bookdetails",r),$.fn.addModule($("#insert_comment"),"G_comment",t),$.fn.addModule($("#insert_login"),"G_login",n)});